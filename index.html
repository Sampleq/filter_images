<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>044 Создание фильтра карточек - практика - с неактивной active</title>
    <style>

        body {
            background-color: rgb(255, 241, 235);
        }

        /* .filter {
             width: 660px;
        } */

        .filter__controls {
            display: flex;
            justify-content: center;
            width: 440px;
            margin: 0 auto;
        }
        .filter__btn {
            width: 80px;
            padding: 5px;
            margin: 10px;
            background-color: rgb(255, 245, 189);
            border: 1px solid rgb(255, 223, 43);
            border-radius: 20px;
            text-align: center;
        }
        .filter__btn:hover {
            background-color: rgb(253, 236, 137);
            cursor: pointer;
        }
        .filter__btn.active {
            background-color: rgb(253, 229, 92);
        }
        .filter__btn.active:hover {
            cursor: default;
        }
        .filter__select {
            display: none;
        }

        .filter__images {
            width: 660px;
            margin: 0 auto;
            text-align: center;
        }

        .filter__image {
            width: 150px;
            height: 150px;
            object-fit: cover;
            margin-top: 10px;
            margin-right: 10px;
            transition: 0.15s !important;
        }
        .filter__image:hover {
            filter: saturate(1.2);
            transform: scale(1.1)!important;
            cursor: pointer;
        }

        @media (max-width: 690px) {
            .filter__controls {
                width: 100%;
            }
            .filter__btn {
                display: none;
            }
            .filter__select {
                display: block;
            }
            .filter__images {
                width: 500px;
            }
            /* .modal__image {
                width: 85vw;
                height: fit-content!important;
            } */
        }

        @media (max-width: 525px) {
            .filter__images {
                width: 95%;
            }
            .filter__image {
                width: 40vw;
                height: 40vw;
                margin-top: 5px;
                margin-right: 5px;
            }
        }

         /* ----------------------------------------------
        * Generated by Animista on 2023-3-12 21:12:52
        * Licensed under FreeBSD License.
        * See http://animista.net/license for more info. 
        * w: http://animista.net, t: @cssanimista
        * ---------------------------------------------- */

        .scale-in-center {
            animation: scale-in-center 0.5s cubic-bezier(0.250, 0.460, 0.450, 0.940) both;
        }
        .swirl-in-fwd {
            animation: swirl-in-fwd 0.6s ease-out both;
        }

        @keyframes scale-in-center {
        0% {
            transform: scale(0);
            opacity: 1;
        }
        100% {
            transform: scale(1);
            opacity: 1;
        }
        }
        
        @keyframes swirl-in-fwd {
        0% {
            transform: rotate(-540deg) scale(0);
            opacity: 0;
            /* filter: blur(5px); */
        }
        100% {
            transform: rotate(0) scale(1);
            opacity: 1;
        }
        }

        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(100, 148, 237, 0.342);
            /* display: flex;  - зададим по клику с посмощью JS*/
            align-items: flex-start;
            display: none;
            overflow: auto;
        }
        .modal__image {
            display: block;
            margin: auto;
            /* width: max-content;  */
            /* height: max-content; */
            max-height: 90vh; 
            max-width: 90vw; 
            
            /* border: 1px solid red; */
            filter: drop-shadow(0 5px 20px #333); 
             
        }
/*
        .modal__wrapper{
            margin: auto;
            width: 80vw;
            height: 80vh;
            border: 1px solid red;
        }
*/
        #close__modal {
            position: fixed;  /* когда у родителя display: flex; - у ребёнка не работает float: right;*/
            top: 2vh;
            right: 3vw;
            font-size: 3em;
            transition: 0.05s;
        }
        #close__modal:hover {
            cursor: pointer;
            font-weight: bold;
            color: red;
            transform: scale(1.2);
        }
    
    </style>
</head>
<body>
    <h2>044 Создание фильтра карточек - практика - с неактивной active</h2>
    <div class="filter">
        <div class="filter__controls">
            <div data-value="all" class="filter__btn active">All</div>
            <div data-value="animals" class="filter__btn">Animals</div>
            <div data-value="people" class="filter__btn">People</div>
            <div data-value="nature" class="filter__btn">Nature</div>

            <select  id="select" class="filter__select">
                <option value="all" selected>All</option>
                <option value="animals">Animals</option>
                <option value="people">People</option>
                <option value="nature">Nature</option>
            </select>
        </div>
        <div class="filter__images">
            <img class="all animals filter__image swirl-in-fwd" src="./bear.jpg" alt="">
            <img class="all animals filter__image swirl-in-fwd" src="./kitty.jpg" alt="">
            <img class="all people filter__image swirl-in-fwd" src="./man1.jpg" alt="">
            <img class="all nature filter__image swirl-in-fwd" src="./nature1.jpg" alt="">
            <img class="all nature filter__image swirl-in-fwd" src="./nature2.jpg" alt="">
            <img class="all nature filter__image swirl-in-fwd" src="./nature3.jpg" alt="">
            <img class="all nature filter__image swirl-in-fwd" src="./nature4.jpg" alt="">
            <img class="all animals filter__image swirl-in-fwd" src="./parrot.jpg" alt="">
            <img class="all animals filter__image swirl-in-fwd" src="./sheep.jpg" alt="">
            <img class="all people filter__image swirl-in-fwd" src="./woman1.jpg" alt="">
            <img class="all people filter__image swirl-in-fwd" src="./woman2.jpg" alt="">
            <img class="all animals filter__image swirl-in-fwd" src="./zebra.jpg" alt="">
        </div>
    </div>

    <!-- // открытие картинки в модальном окне  -->
        <div class="modal">
            <span id="close__modal">&times;</span>
            <!-- <div class="modal__wrapper"> -->
                <img class="modal__image scale-in-center" src="./nature1.jpg" alt="">
            <!-- </div> -->
        </div>

    <script>

        const btns = document.querySelectorAll('.filter__btn');
        const select = document.getElementById('select');
        const images = document.querySelectorAll('.filter__image');

        for(let btn of btns){
            btn.addEventListener('click', filterByBtn);
        }

        select.addEventListener('change', filterBySelect);
        
        function filterByBtn(){
            // alert('btn works!!');
            console.log(this.dataset.value);

            filterImages(this.dataset.value);
            setActiveBtn(this.dataset.value);
            // disableActive(); // можно вынести в отдельную функцию, пока добавил к setActiveBtn
            select.value = this.dataset.value;
        }

        function filterBySelect() {
            filterImages(select.value);
            setActiveBtn(select.value);
        }
        
        function filterImages(selected){
            for(let img of images){
                img.style.display = 'none'
                if(img.classList.contains(selected)){
                    setTimeout(() => {
                        img.style.display = 'inline-block';
                        img.classList.add('swirl-in-fwd'); // добавляем картинке класс с анимацией (мы могли его убирать пр наведении мыши - чтобы работал transform - см. ниже img.onmouseover)
                        } , 16.6);
                }
            }
        }

        function setActiveBtn(selected){
            for(let btn of btns){
                btn.classList.remove('active');
                btn.addEventListener('click', filterByBtn); // ещё раз вешаем листнер на все кнопки (если вдруг листнер был убран при предыдущей смене картинок)
                if(btn.dataset.value === selected){
                    btn.classList.add('active');
                    btn.removeEventListener('click', filterByBtn); //убираем листнер с активной кнопки
                }
            }
        }
        // function disableActive(selected){

        // }

    // открытие картинки в модальном окне       

        for(let img of images){
            img.onclick = function(){

                const modal = document.querySelector('.modal');
                const modalImage = document.querySelector('.modal__image');

                ShowFullImage(this.src);  // внутри ShowFullImage, которая сама находится внутри анонимной функци, (без передавания Аргументом)  спец.элемент this работать не будет.

                const clsModal = document.getElementById('close__modal');

                clsModal.addEventListener('click', closeModal);

                modal.addEventListener('click', closeModalArea);

                function closeModalArea () {
                    console.log(event.target);
                    if(event.target === modal){
                        closeModal();
                    }
                }

                function closeModal (){
                    modal.style.display = 'none'
                    clsModal.removeEventListener('click', closeModal);
                    modal.removeEventListener('click', closeModalArea);
                }

                function ShowFullImage (src) {
                console.log(src);
                modalImage.setAttribute('src', src);
                modal.style.display = 'flex';
            }

            };  

            img.onmouseover = ()=>{img.classList.remove('swirl-in-fwd')}; // при (событии) наведении мыши на картинку убираем класс с анимациее - т.к. уже анимация содержит transform, это свойство не будет работать при hover. transform - у можно задать !important, но transition при hover не работает даже с !important - решаем этот момент убиранием класса с анимацией, когда он нам не нужен
            // img.onmouseout = ()=>{img.classList.add('swirl-in-fwd')};
            
        };

    </script>

</body>
</html>